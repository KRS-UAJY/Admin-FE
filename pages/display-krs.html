<head>
    <link rel="stylesheet" type="text/css" href="css/style-admin.css">
    <link href="css/bootstrap-datatable.min.css" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/bootstrap-table.min.css" rel="stylesheet"/>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
    <!-- <script type="text/javascript" src="js/datatables/media/js/dataTables.jqueryui.min.js"></script> -->
    
</head>
<div class="wrapper">
    <!-- Sidebar Holder -->
    <nav id="sidebar" class="sidebar-bg">
        <div class="sidebar-header">
            <h3>ADMIN KRS ONLINE UAJY</h3>
        </div>

        <ul class="list-unstyled components">
            <li>
                <a class="menu-sidebar" href="#/dashboard" data-toggle="collapse"><i class="fa fa-calendar-alt i-menu"></i>  Set Tanggal KRS</a>
            </li>
            <li class="active">
                <a class="menu-sidebar"><i class="fa fa-list i-menu"></i>  Display KRS</a>
            </li>
            <li>
                <a class="menu-sidebar" href="#/home"><i class="fa fa-sign-out-alt i-menu"></i>  Log Out</a>
            </li>
        </ul>
    </nav>

    <!-- Page Content Holder -->
    <div id="content">

        <nav class="navbar navbar-default">
            <div class="container-fluid">

                <div class="navbar-header">
                    <button type="button" id="sidebarCollapse" class="navbar-btn">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                </div>

                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <h3 class="user-name">Welcome, Andrew</h3>
                </div>
                <!-- <div ng-include="'pages/components/modal-tawar-kls.html'"></div> -->
                <!-- <div ng-include="'pages/components/modal-add-tgl.html'"></div> -->
                
            </div>
        </nav>
        
        <div class="col-md-10 box-form form-group table-handler">
              
                <div class="col-md-11">
                    <table datatable="" dt-options="kelascontroller.dtOptions" dt-columns="kelascontroller.dtColumns" class="row-border hover table-shadow paksa-font">

                    </table>
                </div>

        </div>
        
</div>


<!-- Modal Penawaran Kelas -->
<div id="popup-mk-dipilih" class="modal">

        <!-- Modal content -->
          <div class="modal-content">
              <div class="modal-header">
                  <h2>Tambah Penawaran Kelas</h2>
              </div>
              <div class="modal-body-tawar-kls col-md-12">
                    <div class="col-md-12 modal-body-tawar-kls form-group">
                            <div class="col-md-5">
                                <h3>ID MK : </h3>
                            </div>
                            <div class="col-md-7">
                                <h3 id="tawar_id_kelas"></h3>
                            </div>
                    </div>     
                <div class="col-md-12 modal-body-tawar-kls form-group">
                              <div class="col-md-5">
                                  <h3>Kode MK : </h3>
                              </div>
                              <div class="col-md-7">
                                  <h3 id="tawar_kode_mk"></h3>
                              </div>
                      </div>
                      <div class="col-md-12 modal-body-tawar-kls form-group">
                              <div class="col-md-5">
                                  <h3>Nama MK : </h3>
                              </div>
                              <div class="col-md-7">
                                  <h3 id="tawar_nama_mk"></h3>
                              </div>
                      </div>
                      <div class="col-md-12 modal-body-tawar-kls form-group">
                              <div class="col-md-5">
                                  <h3>Kapasitas Tawar : </h3>
                              </div>
                              <div class="col-md-7">
                                      <input type="number" name="tawar_kapasitas_matakuliah" id="tawar_kapasitas_mk" class="form-control input-lg" placeholder="Hanya angka" onkeypress="return isNumberKey(event)" />
                              </div>
                      </div>
                      <div class="col-md-12 modal-body-tawar-kls form-group">
                              <div class="col-md-6 row">
                                  <button class="btn btn-danger btn-md btn-center" onclick="closeDetail()">Batal</button>
                              </div>
                              <div class="col-md-6 row">
                                  <button class="btn btn-success btn-md btn-center" onclick="updatetawar()">Simpan</button>
                              </div>
                      </div>
              </div>
          </div>
      </div>


 <script type="text/javascript">
     $(document).ready(function () {
         $('#sidebarCollapse').on('click', function () {
             $('#sidebar').toggleClass('active');
             $(this).toggleClass('active');
         });
     });
 </script>


<script>
    function isNumberKey(evt){
        var charCode = (evt.which) ? evt.which : event.keyCode
        if (charCode > 31 && (charCode < 48 || charCode > 57))
            return false;
        return true;
    }    
</script>



<script>
        $(document).on('hidden.bs.modal', function (e) {
            var target = $(e.target);
            target.removeData('bs.modal')
            .find(".modal-body").html('');
        });
</script>

<script>

function closeDetail() {
        
    document.getElementById("popup-mk-dipilih").style.display = "none";
}

function updatetawar() {
    var self = this;
    var id=document.getElementById("tawar_id_kelas").innerHTML;
    var kapasitas=document.getElementById("tawar_kapasitas_mk").value;
    console.log(id);
    var kapasitas_kelas=10; 
    let data = {
	"id_kelas": id,
	"kapasitas_tawar": kapasitas
}
    console.log(data);
    var store = JSON.parse(localStorage.getItem('ngStorage-currentUser'));
    let axiosConfig = {
                headers: {
                    'Content-Type': 'application/json;charset=UTF-8',
                    "Authorization" : "Bearer "+store.token,
                    "Access-Control-Allow-Origin": "*",
                }
              };
             axios.put('http://127.0.0.1:5030/api/kelas', data, axiosConfig)  
             .then((result) => {
             console.log("RESPONSE RECEIVED: ", result);
             document.getElementById("popup-mk-dipilih").style.display = "none";
             swal("Berhasil", "Kapasitas Berhasil Diubah", "success");
             document.getElementById("tawar"+id).innerHTML=kapasitas;
             });
             
}

</script>